<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
    <meta name="keywords" content="hexo, autumn, phosphorus15, cs">
    <title>
        Phosphorus&#39; Blog
    </title>
    <!-- favicon -->
    
    <link rel="icon" href="https://cdn.jsdelivr.net/gh/frontendsophie/hexo-theme-autumn@1.0.0/source/img/favicon.ico">
    
    <link rel="stylesheet" href="/css/style.css">

    <!-- highlight -->
    <link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.12.0/styles/github-gist.min.css">
    <script src="//cdn.bootcss.com/highlight.js/9.2.0/highlight.min.js"></script>
    <script>
        hljs.initHighlightingOnLoad()
    </script>
    <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/frontendsophie/hexo-infinite-scroll@1.0.0/dist/hexo-infinite-scroll.min.css">
    <script src="https://cdn.jsdelivr.net/gh/frontendsophie/hexo-infinite-scroll@1.0.0/dist/hexo-infinite-scroll.min.js"></script>
    <script>
        infiniteScroll()

        // for mobile menu
        $(function () {
            $('.social-button').click(function () {
                if ($('.social-links').hasClass('hide-links')) {
                    $('.social-links').removeClass('hide-links')
                } else {
                    $('.social-links').addClass('hide-links')
                }
            })
        })
    </script>
</head>

    <body style="background: url(https://cdn.jsdelivr.net/gh/frontendsophie/hexo-theme-autumn@1.0.0/source/img/button-bg.png) #f3f3f3">
        <div class="container">
            <header class="header">
    <h1 class="title">
        <a href="/" class="logo">
            Phosphorus&#39; Blog
        </a>
    </h1>
    <h2 class="desc">
        Learning, Discovering, Exploiting
    </h2>

    <nav class="links">
        <button class="social-button">
            menu
        </button>
        <ul class="social-links hide-links">
            
                <li>
                    <a href="https://github.com/Phosphorus15">
                        Github
                    </a>
                </li>
                
                <li>
                    <a href="https://blog.csdn.net/wxx1237/">
                        CSDN
                    </a>
                </li>
                
        </ul>
    </nav>
</header>
                <main class="main">
                    <article class="post">
    
    
    
    <h2 class="post-title">
        15号的CTF日记 (一)
    </h2>
    <ul class="post-date">
        <li>
            2019-02-09
        </li>
        <li>
            Phosphorus15
        </li>
    </ul>
    <div class="post-content">
        <p>拖拖延延地过了一个学期，先是各种大大小小的项目，后来又是期中期末考和C++实习。在放寒假的第一天，我终于踏上了CTF道路的第一步。</p>
<p>​    因为今天晚上才到家，因此只是跟着蓝学长一起做了两道基础的<code>misc</code>题目。</p>
<h4 id="绕"><a href="#绕" class="headerlink" title="绕"></a><a href="http://www.shiyanbar.com/ctf/1847" target="_blank" rel="noopener">绕</a></h4><p><strong>题面</strong>：</p>
<p>​    也就是脑筋急转弯</p>
<pre><code>hint：把出题人的名字拿去加密，233 

格式：ctf{} 
</code></pre><p>​        解题链接在<a href="http://ctf5.shiyanbar.com/misc/page" target="_blank" rel="noopener">/misc/page</a></p>
<p><strong>解法</strong>:</p>
<p>​    把网页中<code>javascript</code>里的<code>_</code>变量在调试模式下用<code>console.log</code>输出，需要注意的是，此操作应在<code>eval(_)</code>之前，因为eval过程中删除掉了<code>_</code>变量。 （其实窝一开始就被怎么处理这个<code>_</code>卡了半天XDD，后面还是学长告诉我要格式化）</p>
<p>​    得出以下js代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">$</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> e = <span class="built_in">document</span>.getElementById(<span class="string">"c"</span>).value;</span><br><span class="line">    <span class="keyword">if</span> (e.length == <span class="number">16</span>)</span><br><span class="line">        <span class="keyword">if</span> (e.match(<span class="regexp">/^22a60b/</span>) != <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">if</span> (e.match(<span class="regexp">/0b310/</span>) != <span class="literal">null</span>)</span><br><span class="line">                <span class="keyword">if</span> (e.match(<span class="regexp">/e5ece$/</span>) != <span class="literal">null</span>)</span><br><span class="line">                    <span class="keyword">if</span> (e.match(<span class="regexp">/0ebe5/</span>) != <span class="literal">null</span>) &#123;</span><br><span class="line">                        <span class="keyword">var</span> t = [<span class="string">"U2FsdG"</span>, <span class="string">"S481hY"</span>, <span class="string">"7lo/"</span>, <span class="string">"IBh2Waw=="</span>];</span><br><span class="line">                        <span class="keyword">var</span> n = [<span class="string">"VkX182"</span>, <span class="string">"9lDS37"</span>, <span class="string">"Dtcv78qFew"</span>];</span><br><span class="line">                        <span class="keyword">var</span> r = [<span class="string">"eA/"</span>, <span class="string">"kNjZ1UZ"</span>, <span class="string">"6LuMTMoP2"</span>];</span><br><span class="line">                        <span class="keyword">var</span> i = [<span class="string">"8U/2KZ"</span>, <span class="string">"tCckgQoGA"</span>, <span class="string">"mEapD0Y"</span>];</span><br><span class="line">                        <span class="keyword">var</span> s = [t, n, r, i];</span><br><span class="line">                        <span class="keyword">for</span> (<span class="keyword">var</span> o = <span class="number">0</span>; o &lt; <span class="number">13</span>; ++o) &#123;</span><br><span class="line">                            <span class="built_in">document</span>.write(s[o % <span class="number">4</span>][<span class="number">0</span>]);</span><br><span class="line">                            s[o % <span class="number">4</span>].splice(<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">document</span>.write(<span class="string">'&lt;input id="c"&gt;&lt;button onclick=$()&gt;Ok&lt;/button&gt;'</span>);</span><br><span class="line"><span class="keyword">delete</span> _ p</span><br></pre></td></tr></table></figure>
<p>值得注意的是，此js用了一系列的正则匹配以及一个长度约束，我们可以推导出唯一满足所有条件的<code>e</code>，那就是<code>22a60b310ebe5ece</code>，在输入框里键入这个串，获得输出结果<code>U2FsdGVkX182eA/8U/2KZS481hY9lDS37kNjZ1UZtCckgQoGA7lo/Dtcv78qFew6LuMTMoP2mEapD0YIBh2Waw==</code></p>
<p>这个闭着眼睛看都知道是Base64 XDD，于是乎我们把它解码，得到一串以下内容</p>
<p><code>Salted__6xüSýe.&lt;Ö=4·îCcgU´&#39;$¹hü;\¿¿*ì:.ã2öF©Fk</code></p>
<p>显然，这是一串乱码，代表它被进行过某种程度的加密或者混淆，再结合此串的<code>Salted</code>开头，根据（学长告诉我的~）经验，这意味着这个串经过了<code>AES/DES</code>加密。</p>
<p>尝试将出题人的名字进行16位MD5哈希，得到<code>22a60b310ebe5ece</code>，不难发现，这个串和前面获得js输出的串完全一样，因此我们猜测这个串就是对称加密的密钥。这时我们使用<a href="https://www.sojson.com/encrypt_aes.html" target="_blank" rel="noopener">简单AES解密工具</a>，很快得出结果<code>ctf%7BConsole.log%28shiyanbar%29%7D</code>，经过一番解URL编码，获得flag~</p>
<h4 id="SOS"><a href="#SOS" class="headerlink" title="SOS"></a><a href="http://www.shiyanbar.com/ctf/1850" target="_blank" rel="noopener">SOS</a></h4><p>​    学长给我安利这道题目，目的是让我熟悉部分相关工具（结果窝直接一莽在linux下一个<code>file</code>发现这个是<code>ext2</code>的fs文件，噗噗）</p>
<p><strong>题面</strong>:</p>
<p>​     一份来自外太空的文件 </p>
<pre><code>格式：CTF{} 
</code></pre><p>​        解题链接在 <a href="http://ctf5.shiyanbar.com/misc/sos" target="_blank" rel="noopener">/misc/sos</a></p>
<p><strong>解法</strong>:</p>
<p>​    首先用<code>HxD</code>查看十六进制，推测这是一个fs文件，再用<code>binwalk</code>分析，发现是一个根目录下有大量<code>gzip</code>文件的文件系统~</p>
<p>​    在linux下使用<code>binwalk -e</code>命令提取所有内容，并用一个python脚本将所有gzip文件解压</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gzip</span><br><span class="line"></span><br><span class="line">path=<span class="string">r"./%d"</span></span><br><span class="line">s=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">1</span>, <span class="number">242</span> + <span class="number">1</span>):</span><br><span class="line">    f=gzip.open(path % i).read()</span><br><span class="line">    s+=f</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> s</span><br></pre></td></tr></table></figure>
<p>这样，我们就得到了一段文字</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">I&apos;m from Black Eye Galaxy,Our spaceship broke down when we passed Mars.We need your help and we are available at any terminal.The key to contact us is CTF&#123;131Ack_3Y3_gA1AxY&#125;.Please contact us as soon as possible.we need your help desperately.</span><br></pre></td></tr></table></figure>
<p>flag就在其中啦w，需要注意的是，<code>binwalk</code>只有在linux下才能很好地用于提取文件中的内容（在win下面缺少必要依赖）</p>
<h4 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h4><p>​    第一次接触到ctf的题型，窝其实还是挺激动的~虽然在解题过程中因为经验不足消耗了不少时间，但是在学长的帮助下，我还是很好地把题目做了出来~</p>
<p>​    题目并没有想象中的难（可能是难度比较入门级…），做起来也挺有意思的。总的来说，感觉这个比赛还是挺适合我的~明天继续加油鸭w</p>

    </div>
</article>
                </main>
                <aside class="aside">
                    <section class="aside-section">
                        
    <h1>Categories</h1>

    

                    </section>
                    <section class="aside-section">
                        
    <h1>Archives</h1>

    <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/">2019</a></li></ul>


                    </section>
                    <section class="aside-section tag">
                        
    <h1>Tags</h1>

    <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/article/">article</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ctf/">ctf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cybersecurity/">cybersecurity</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/test/">test</a></li></ul>

                    </section>
                </aside>
        </div>
    </body>

</html>